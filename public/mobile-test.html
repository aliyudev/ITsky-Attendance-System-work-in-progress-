<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile GPS Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 5px;
            width: 100%;
        }
        .btn:hover {
            background: #0056b3;
        }
        .result {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 4px solid #007bff;
        }
        .error {
            background: #ffebee;
            border-left-color: #f44336;
        }
        .success {
            background: #e8f5e8;
            border-left-color: #4caf50;
        }
        .status {
            font-weight: bold;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üì± Mobile GPS Test</h1>
        <p>This page helps test GPS location on mobile devices.</p>
        
        <button onclick="testGPS()" class="btn">üîç Test GPS Location</button>
        <button onclick="clearResults()" class="btn" style="background: #6c757d;">üóëÔ∏è Clear Results</button>
        
        <div id="results"></div>
        
        <div class="result">
            <div class="status">üí° Mobile GPS Tips:</div>
            <ul>
                <li>Make sure GPS is enabled in your device settings</li>
                <li>Allow location access when Chrome asks</li>
                <li>Try going outside for better GPS signal</li>
                <li>Check if Chrome has location permission in settings</li>
                <li>Try refreshing the page if it doesn't work</li>
            </ul>
        </div>
    </div>

    <script>
        function testGPS() {
            const results = document.getElementById('results');
            results.innerHTML = '<div class="result">üîÑ Requesting GPS location...</div>';
            
            if (!navigator.geolocation) {
                results.innerHTML = '<div class="result error">‚ùå Geolocation not supported by this browser</div>';
                return;
            }
            
            const options = {
                enableHighAccuracy: true,
                timeout: 15000,
                maximumAge: 0
            };
            
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    const accuracy = position.coords.accuracy;
                    const timestamp = new Date(position.timestamp).toLocaleString();
                    
                    // Calculate distance to office
                    const officeLat = 9.0820;
                    const officeLng = 7.3983;
                    const distance = calculateDistance(lat, lng, officeLat, officeLng);
                    
                    results.innerHTML = `
                        <div class="result success">
                            <div class="status">‚úÖ GPS Location Obtained!</div>
                            <p><strong>Your Location:</strong></p>
                            <p>Latitude: ${lat}</p>
                            <p>Longitude: ${lng}</p>
                            <p>Accuracy: ${accuracy} meters</p>
                            <p>Time: ${timestamp}</p>
                            <hr>
                            <p><strong>Distance to Office:</strong> ${Math.round(distance)} meters (${(distance/1000).toFixed(2)} km)</p>
                            <p><strong>Status:</strong> ${distance <= 10000 ? '‚úÖ Within range' : '‚ùå Too far'}</p>
                        </div>
                    `;
                },
                (error) => {
                    let errorMsg = 'Unknown error occurred';
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            errorMsg = '‚ùå Location permission denied. Please allow location access in Chrome settings.';
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMsg = '‚ùå Location information unavailable. Check if GPS is enabled.';
                            break;
                        case error.TIMEOUT:
                            errorMsg = '‚ùå Location request timed out. Try again.';
                            break;
                    }
                    results.innerHTML = `<div class="result error">${errorMsg}</div>`;
                },
                options
            );
        }
        
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371e3; // Earth's radius in meters
            const œÜ1 = lat1 * Math.PI / 180;
            const œÜ2 = lat2 * Math.PI / 180;
            const ŒîœÜ = (lat2 - lat1) * Math.PI / 180;
            const ŒîŒª = (lon2 - lon1) * Math.PI / 180;

            const a = Math.sin(ŒîœÜ / 2) * Math.sin(ŒîœÜ / 2) +
                Math.cos(œÜ1) * Math.cos(œÜ2) *
                Math.sin(ŒîŒª / 2) * Math.sin(ŒîŒª / 2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));

            return R * c; // Distance in meters
        }
        
        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }
    </script>
</body>
</html> 